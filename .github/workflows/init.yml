name: Init Repo Context

on:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  init:
    runs-on: ubuntu-latest
    steps:
      - name: Initialize update server repository context
        id: init
        shell: bash
        run: |
          set -euo pipefail

          REPO_SLUG="${GITHUB_REPOSITORY}"
          SERVER_URL="${GITHUB_SERVER_URL:-https://github.com}"
          UPDATE_XML_REPO_URL="${SERVER_URL}/${REPO_SLUG}"

          echo "update_xml_repo_url=${UPDATE_XML_REPO_URL}" >> "$GITHUB_OUTPUT"

      - name: Print resolved value
        run: |
          echo "UPDATE_XML_REPO_URL=${{ steps.init.outputs.update_xml_repo_url }}"
